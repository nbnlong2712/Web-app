# Story 1.13: Implement Analytics Integration

## Status
Draft

## Story
**As a** product owner,
**I want** to track user interactions and tool performance,
**so that** I can measure CTR and optimize the user experience.

## Acceptance Criteria
1. Plausible or GA4 analytics is integrated
2. Events are tracked for tool_card_view, visit_click, search_submit
3. Simple admin metrics page displays CTR, top tools, top tags
4. Analytics events are properly categorized and labeled
5. Privacy considerations are addressed
6. Analytics integration doesn't impact performance

## Tasks / Subtasks
- [ ] Integrate analytics provider
  - [ ] Set up Plausible or GA4 account
  - [ ] Add analytics script to application
  - [ ] Configure environment variables for analytics keys
- [ ] Implement event tracking
  - [ ] Add tracking for `tool_card_view` events
  - [ ] Add tracking for `visit_click` events
  - [ ] Add tracking for `search_submit` events
  - [ ] Ensure events include relevant metadata
- [ ] Create admin metrics page
  - [ ] Create `/admin/metrics` page
  - [ ] Display 7/30-day CTR
  - [ ] Show top tools and top tags
  - [ ] Implement charts for clicks-per-day
- [ ] Address privacy considerations
  - [ ] Ensure analytics complies with privacy requirements
  - [ ] Document data collection practices
  - [ ] Implement opt-out mechanism if required
- [ ] Test analytics integration
  - [ ] Verify events are tracked correctly
  - [ ] Test admin metrics page functionality
  - [ ] Verify performance impact is minimal

## Dev Notes
### Analytics Requirements
- Integrate Plausible or GA4
- Events: `tool_card_view`, `visit_click`, `search_submit`
- Simple `/admin/metrics` page with CTR, top tools, top tags

[Source: docs/epic/epic-i-analytics-kpi.md]

### Observability & Analytics
- **Analytics provider:** Plausible or GA4 with events: `tool_card_view`, `visit_click`, `search_submit`
- **Dashboards:** 7/30‑day CTR, top outbound tools, clicks/day

[Source: docs/architecture/7-observability-analytics.md]

### Project Structure
```
ai-tools-library/
├─ lib/
│  ├─ analytics.ts                    # Plausible/GA wrappers
├─ app/
│  └─ admin/
│     └─ metrics/
│        └─ page.tsx                  # Admin metrics page
```

[Source: docs/architecture/source-tree.md]

### Performance & Quality Budgets
- Analytics integration should not significantly impact page performance
- Use asynchronous loading for analytics scripts

[Source: docs/architecture/coding_standards.md#9]

## Testing
### Test file location
- Tests should be placed in `tests/e2e/` directory for end-to-end testing
- Test files: `tests/e2e/analytics.test.ts`, `tests/e2e/admin-metrics.test.ts`

### Test standards
- Verify analytics events are fired correctly
- Test admin metrics page displays data accurately
- Ensure analytics integration doesn't break other functionality
- Verify privacy considerations are properly implemented

### Testing frameworks and patterns to use
- Use Playwright for end-to-end testing of analytics
- Mock analytics provider for testing event tracking
- Test admin metrics page with sample data
- Verify performance impact is within acceptable limits

[Source: docs/architecture/coding_standards.md#8]

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
|      |         |             |        |

## Dev Agent Record
### Agent Model Used
TBD

### Debug Log References
TBD

### Completion Notes List
TBD

### File List
TBD

## QA Results
TBD